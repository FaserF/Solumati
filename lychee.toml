################################################################################
# Lychee Link Checker Configuration
# This file configures link validation for CI/CD pipelines.
################################################################################

# 1. VISIBILITY & FORMATTING


# 2. CHECK SCOPE
# File patterns are specified via command-line arguments in the GitHub workflow
# (see .github/workflows/ci-main.yml)


# 3. EXCLUSIONS
# Exclude URLs that commonly fail checks or are placeholders
exclude = [
    # Template variables and placeholders (JS template literals)
    '.*\$\{.*\}.*',           # Variables like ${VAR}
    '.*%7B.*%7D.*',           # URL-encoded variables
    '.*\$\{.*',               # Incomplete template literals

    # Placeholder domains
    '^https?://solumati\.com',
    '^https?://example\.com',
    '^https?://your-domain\.com',

    # Auth-required portals (return 403 without login)
    '^https?://dash\.cloudflare\.com',
    '^https?://portal\.azure\.com',
    '^https?://console\.cloud\.google\.com',

    # External APIs (may rate-limit or block CI without auth)
    '^https?://api\.qrserver\.com',
    '^https?://api\.github\.com',

    # Dynamic release tag URLs (these are runtime-generated and may not exist yet)
    '.*/releases/tag/v?\$',
    '.*/releases/tag/$',

    # Local development URLs (may not be reachable in CI)
    '^https?://localhost',
    '^https?://127\.0\.0\.1',
    '^https?://0\.0\.0\.0',

    # Mail links
    '^mailto:',

    # File links (local references)
    '^file://'
]

# 4. NETWORK & RETRY
timeout = 10
retry = 3
max_retries = 3

# 5. ACCEPTANCE
# We accept 429 (Too Many Requests) as valid to avoid failing builds on transient issues
accept = [200, 204, 429]
